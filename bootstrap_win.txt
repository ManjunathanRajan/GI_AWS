<powershell>
# Enable WinRM
Enable-PSRemoting -Force
Set-WSManQuickConfig -Force

# Configure WinRM settings
winrm quickconfig -quiet -Force
winrm set winrm/config '@{MaxTimeoutms="1800000"}' -Force
winrm set winrm/config/winrs '@{MaxMemoryPerShellMB="1024"}' -Force
winrm set winrm/config/service/auth '@{Basic="true"}' -Force
winrm set winrm/config/service '@{AllowUnencrypted="true"}' -Force
winrm set winrm/config/client/auth '@{Basic="true"}' -Force
winrm set winrm/config/client '@{AllowUnencrypted="true"}' -Force

# Create a rule in the Windows Firewall to allow WinRM traffic
New-NetFirewallRule -DisplayName "Allow WinRM" -Direction Inbound -LocalPort 5985 -Protocol TCP -Action Allow -Force
</powershell>
